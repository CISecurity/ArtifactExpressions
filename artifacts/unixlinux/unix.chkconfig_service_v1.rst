Unix: Chkconfig Service
=======================

Description
-----------

The Unix: Chkconfig Service test is used to check information about
which runlevel specified services are scheduled to exist. For more
information see the output generated by a chkconfig â€“list.

The required runlevel_object element is used by a runlevel_test to
define the specific service(s)/runlevel combination to be evaluated.

The optional runlevel_state element holds information about whether a
specific service is scheduled to start or stop at a given runlevel.

Technical Details
-----------------

Artifact Parameters
~~~~~~~~~~~~~~~~~~~

Human ID:
   -  unix.chkconfig_service_v1

======= ====== ======================================================
Name    Type   Description
======= ====== ======================================================
service string The name of the service to be tested. Cannot be blank.
======= ====== ======================================================

Supported Test Types
~~~~~~~~~~~~~~~~~~~~

-  Unix: Service Enabled

Test Type Parameters
~~~~~~~~~~~~~~~~~~~~

Human ID:
   -  unix.service_enabled_v1

======= ====== ================================
Name    Type   Description
======= ====== ================================
enabled string Is the service enabled? (Yes/No)
======= ====== ================================

Generated Content
~~~~~~~~~~~~~~~~~

XCCDF+AE
^^^^^^^^

This is what the AE check looks like, inside a Rule, in the XCCDF

::

   <xccdf:complex-check operator="AND">
     <xccdf:check system="https://benchmarks.cisecurity.org/ae/0.5">
       <xccdf:check-content>
         <ae:artifact_expression id="xccdf_org.cisecurity.benchmarks_ae_[SECTION-NUMBER]">
           <ae:artifact_oval_id>[ARTIFACT-OVAL-ID]</ae:artifact_oval_id>
           <ae:title>[RECOMMENDATION-TITLE]</ae:title>
           <ae:artifact type="[ARTIFACT-TYPE-NAME]">
             <ae:parameters>
               <ae:parameter dt="string" name="service_name">[service_name.value]</ae:parameter>
             </ae:parameters>
           </ae:artifact>
           <ae:test type="[TEST-TYPE-NAME]">
             <ae:parameters>
               <ae:parameter dt="string" name="enabled">[enabled.value]</ae:parameter>
             </ae:parameters>
           </ae:test>
           <ae:profiles>
             <ae:profile idref="xccdf_org.cisecurity.benchmarks_profile_Level_1 "/>
         </ae:profiles>          
         </ae:artifact_expression>
       </xccdf:check-content>
     </xccdf:check>
   </xccdf:complex-check>

SCAP
^^^^

XCCDF
'''''

For ``unix.chkconfig_service_v1`` artifacts, the xccdf:check looks like
this. There is no Value element in the XCCDF for this Artifact.

::
   <xccdf:complex-check operator="AND">
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
         <check-content-ref
            href="[BENCHMARK-TITLE]"
            name="oval:org.cisecurity.benchmarks.[PLATFORM]:def:[ARTIFACT-OVAL-ID]"
            />

      </check>

   </xccdf:complex-check>

OVAL
''''

Test

::

   <runlevel_test 
     xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix"
     id="oval:org.cisecurity.benchmarks.[PLATFORM]:tst:[ARTIFACT-OVAL-ID]"
     check_existence="[check_existence.value]"
     check="[check.value]"
     comment="[RECOMMENDATION-TITLE]"
     version="1">
     <object object_ref="oval:org.cisecurity.benchmarks.[PLATFORM]:obj:[ARTIFACT-OVAL-ID]" />
     <state state_ref="oval:org.cisecurity.benchmarks.[PLATFORM]:ste:[ARTIFACT-OVAL-ID]" />
   </runlevel_test>

Object

::

   <runlevel_object 
     xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix"
     id="oval:org.cisecurity.benchmarks.[PLATFORM]:obj:[ARTIFACT-OVAL-ID]"
     comment="[RECOMMENDATION-TITLE]"
     version="1">
     <service_name>
       [service_name.value]
     </service_name>
     <runlevel 
       operation="pattern match">
       .*
     </runlevel>
   </runlevel_object>

State

::

   <runlevel_state 
     xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix"
     id="oval:org.cisecurity.benchmarks.[PLATFORM]:ste:[ARTIFACT-OVAL-ID]"
     comment="[RECOMMENDATION-TITLE]"
     version="1">
     <start 
       datatype="boolean" 
       operation="equals">
       [start.value]
     </start>
   </runlevel_state>

YAML
^^^^

::

   artifact-expression:
     artifact-unique-id: "[ARTIFACT-OVAL-ID]"
     artifact-title: "[RECOMMENDATION-TITLE]"
     artifact:
       type: "[ARTIFACT-TYPE-NAME]"
       parameters:
         - parameter: 
             name: "service_name"
             dt: "string"
             value: "[service_name.value]"
     test:
       type: "[TEST-TYPE-NAME]"
       parameters:
         - parameter: 
             name: "enabled"
             dt: "string"
             value: "[enabled.value]"

JSON
^^^^

::

   {
     "artifact-expression": {
       "artifact-unique-id": "[ARTIFACT-OVAL-ID]",
       "artifact-title": "[RECOMMENDATION-TITLE]",
       "artifact": {
         "type": "[ARTIFACT-TYPE-NAME]",
         "parameters": [
           {
             "parameter": {
               "name": "service_name",
               "type": "string",
               "value": "[service_name.value]"
             }
           }
         ]
       },
       "test": {
         "type": "[TEST-TYPE-NAME]",
         "parameters": [
           {
             "parameter": {
               "name": "enabled",
               "type": "string",
               "value": "[enabled.value]"
             }
           }
         ]
       }
     }
   }
